"use strict";_theme.SearchResult=function(){var selectors={container:".search-result-main",search_result:"[data-result-container]",no_result:".no-result",no_resultcollectionsSection:".no-result.collectionsSection",searchNoResultCollections:".searchNoResultCollections",sortby_select:"[data-sortby] select",sortby_select_item:"[data-sortby] .dropdown-menu li",filter_wrapper:"[data-filter-items]",filter_item:"[data-filter-items] [data-filter-item]",result_count:"[data-result-count]",search_query:"[data-search-query]",filter_heading:".search-result-filter [data-filter-item] .search-filter-title",searchResultWrapper:"[data-search-results-wrapper]",gridItem:"[data-search-results-wrapper] .grid-item",loadMore:"[data-loadmore]",loadMoreButton:"[data-loadmore] .loadmore-btn",loadMoreProductsCount:"[data-loadmore] .number_count",loadMoreTotalCount:"[data-loadmore] .total_count",searchInput:'.search-child-div input[name="q"]',paginationLoader:"[data-custom-loader]",filterToggle:"[data-filter-toggle]",filterSearchInputs:"[data-filter-items] input[name='search_filter']",filterViewCTA:"[data-filter-view]",filterClearAllCTA:"[data-filter-clear-all]",desk_filterClearAllCTA:"[data-filter-clear-all][data-device-desk]",filterClear:"[data-filter-items] .filter-selected-clear",dropdown:"[data-sortby-wrapper] [data-toggle='dropdown']",dropdownMenuList:"[data-sortby-wrapper] .dropdown-menu",limitedview_item:"[data-limited-view] .dropdown-menu li",promoBannerWrapper:"[data-promo-banner]",promoBanner:"[data-promo-banner] .promo-banner",statusText:"#search-page-ajax-status",resultInfo:"[data-result-info]"},settings={start_index:0,end_index:18,products_per_page:16,total_result:0,total_loaded:0,current_page:1,query:"",sort_by:"",is_pagination:!1,exclude_filter_items:["+","nostar"],selected_price:null,filter_item_min_qty:1,cached_url:{},filter_open_class:"filter-open",base_url:"https://www.searchanise.com/getresults?api_key=2K7F7z9Y9V&items=true&facets=true&facetsShowUnavailableOptions=true&output=jsonp",search_container:["brand"],filter_search_html:'<div class="filter_search"><input type="search" name="search_filter" aria-label="search [[FILTER_HEADING]]" placeholder="Search by [[FILTER_HEADING]]"></div>',filter_html:'<div data-filter-item  data-filter-name="[[Filter_Name]]" class="[[FILTER_ACTIVE_CLASS]]"><button type="button" class="search-filter-title [[FILTER_OPEN_CLASS]]" aria-label="[[FILTER_HEADING]] filter" aria-expanded="[[FILTER_OPEN_CLASS_STATUS]]"><span>[[FILTER_HEADING]] [[FILTER_SELECTED_COUNT]]</span></button>[[ACTIVE_FILTER_HTML]]<div class="filter-list [[FILTER_OPEN_CLASS]]">[[FILTER_SEARCH]]<ul class="scroll-list">[[FILTER_OPTIONS]]</ul></div></div>',filter_price_html:'<li data-value="Price"><div class="price-selected"><span id="price-selected-min" class="price-selected-col price-selected-min"><span class="visually-hidden">minimum price [[PRICE_LEFT]]</span><span data-price-txt>[[PRICE_LEFT]]</span></span><span id="price-selected-max" class="price-selected-col price-selected-max"><span class="visually-hidden">maximum price [[PRICE_RIGHT]]</span><span data-price-txt>[[PRICE_RIGHT]]</span></span></div><div id="filter-price-range"></div><div class="price-range-info"><input type="text" aria-label="minimum price [[PRICE_FROM]]" class="price-range-info-min" data-price-from="[[PRICE_FROM_UNFORMATTED]]" value="[[PRICE_FROM]]" tabindex="-1" readonly /><input type="text" aria-label="maximum price [[PRICE_TO]]" class="price-range-info-max" data-price-to="[[PRICE_TO_UNFORMATTED]]" value="[[PRICE_TO]]" tabindex="-1" readonly /><input type="hidden" name="restrictBy[price]" class="price-range-full" value="[[PRICE_FROM_TO_UNFORMATTED]]" readonly [[PRICE_FILTER_STATUS]] /></div></li>',filter_item_html:'<li data-value="[[VALUE]]"><input aria-controls="search-page-ajax-status" class="outline-inset" type="checkbox" name="[[TITLE]]" aria-label="[[TITLE]] [[VALUE]]" value="[[VALUE_ENCODE]]" id="[[TITLE_VALUE]]" [[Check_Status]]><label class="outline-inset" for="[[TITLE_VALUE]]">[[VALUE]] [[VALUE_COUNT]]</label></li>',filter_rating_html:'<li data-value="[[VALUE]]"><input type="checkbox" name="[[TITLE]]" value="[[VALUE_ENCODE]]" id="[[TITLE_VALUE]]" [[Check_Status]]><label for="[[TITLE_VALUE]]">[[VALUE_FORMATTED]]</label></li>'};function SearchResult(){const container=document.querySelector(selectors.container);if(!container)return;const self=this;this.headerSearch=document.querySelector("header-search"),this.container=container,settings.products_per_page=container.dataset.perpage||16;const url_obj=new URL(window.location.href);settings.sort_by=this.container.querySelector(selectors.sortby_select).value,settings.query=url_obj.searchParams.get("q")||"",settings.base_url+="&q="+settings.query,document.querySelectorAll(settings.searchInput).forEach(function(input){this.value=settings.query});let initial_max_result=Number(settings.products_per_page);document.querySelector(selectors.promoBanner)&&(initial_max_result+=2);const initialURL=settings.base_url+"&sortBy="+settings.sort_by+"&startIndex="+settings.start_index+"&maxResults="+initial_max_result;_theme.toggleLoading(1),this.fetchSearchResults(initialURL,function(data){try{if(customElements.get("header-search")){const statusText=`Search: ${data.totalItems} results found for "${settings.query}" \u2013 Perfumania`;self.headerSearch.input.value=settings.query,self.headerSearch.setLiveRegionText(statusText),document.title=statusText}}catch(err){console.error(err)}}),this.initEvents()}return SearchResult.prototype.fetchSearchResults=function(fetch_url,callback){if(!fetch_url)return;const self=this;if(self.container.classList.add("loading"),this.updateStatusText("Please wait, content loading"),settings.cached_url[fetch_url]){runSideEffect(settings.cached_url[fetch_url]);return}fetch(fetch_url).then(function(res){return res.json()}).then(function(data){settings.cached_url[fetch_url]=data,runSideEffect(data)}).catch(function(err){self.updateStatusText("Something went wrong while fetching data"),self.container.classList.remove("loading"),self.container.removeAttribute("data-loading"),_theme.toggleLoading(0),console.log(err)});function runSideEffect(data){settings.total_result=data.totalItems,settings.is_pagination?settings.total_loaded+=data.currentItemCount:settings.total_loaded=data.currentItemCount,settings.end_index=settings.total_loaded;const no_result=self.container.querySelector(selectors.no_result),no_resultcollectionsSection=self.container.querySelector(selectors.no_resultcollectionsSection),search_result=self.container.querySelector(selectors.search_result);self.buildTotalCount(data.totalItems),data.facets&&self.buildFilter(data.facets),data.totalItems&&data.totalItems>0?(self.container.classList.remove("no--result"),search_result.classList.remove("hidden"),no_result.classList.add("hidden"),no_resultcollectionsSection.classList.add("hidden"),no_result.querySelector("a").tabIndex="-1",self.buildProductGrid(data.items),self.buildPagination(data)):(self.container.classList.add("no--result"),search_result.classList.add("hidden"),no_result.classList.remove("hidden"),no_resultcollectionsSection.classList.remove("hidden"),no_result.querySelector("a").removeAttribute("tabIndex"),document.querySelector("body").classList.add("noResult")),callback&&typeof callback=="function"&&callback(data),setTimeout(function(){self.container.classList.remove("loading")},1e3),self.container.removeAttribute("data-loading"),_theme.toggleLoading(0),self.updateStatusText(data.totalItems+" products are loaded successfully")}},SearchResult.prototype.buildTotalCount=function(totalItems){const resultCounts=this.container.querySelectorAll(selectors.result_count),searchQuery=this.container.querySelector(selectors.search_query);resultCounts.forEach(function(countElem){countElem.textContent=totalItems}),searchQuery&&(searchQuery.textContent="\u201C"+settings.query+"\u201D");const infoElem=this.container.querySelector(selectors.resultInfo);infoElem&&infoElem.setAttribute("role","alert")},SearchResult.prototype.buildFilter=function(filter_items){const self=this;let filter_html_main="",price_from=0,price_to=0,price_from_left=0,price_to_left=0,all_filter_selected_count=0;const unavailable_filters=[];filter_items.filter(function(item){let item_title=item.title.trim().toLowerCase();item.buckets.filter(function(b){return b.count>0}).length===0&&unavailable_filters.push(item_title)}),filter_items.sort(function(x,y){return x.title.toLowerCase()=="gender"?-1:y.title.toLowerCase()=="gender"?1:0}),filter_items.map(function(item){let item_title=item.title.trim().toLowerCase();const filter_name="restrictBy["+item.attribute+"]";if(item_title!=="price"&&(item.buckets.length===0||unavailable_filters.indexOf(item_title)>-1))return!1;let filter_html=settings.filter_html,filter_item_main="",is_filter_open=!1;if(settings.search_container.includes(item_title)){let filter_search_html=settings.filter_search_html;filter_search_html=self.updateHtml(filter_search_html,"[[FILTER_HEADING]]",item_title),filter_html=self.updateHtml(filter_html,"[[FILTER_SEARCH]]",filter_search_html)}else filter_html=self.updateHtml(filter_html,"[[FILTER_SEARCH]]","");filter_html=self.updateHtml(filter_html,"[[FILTER_HEADING]]",item_title),filter_html=self.updateHtml(filter_html,"[[Filter_Name]]",filter_name),document.querySelector('[data-filter-items] [data-filter-name="'+filter_name+'"] .search-filter-title.open')&&(is_filter_open=!0);let filter_selected_count=0;const buckets=[];if(item.buckets.map(function(b){b.selected&&buckets.push(b)}),item.buckets.map(function(b){b.selected||buckets.push(b)}),buckets.map(function(b){let hide_val=!1;if((b.count<settings.filter_item_min_qty||settings.exclude_filter_items.indexOf(b.value)>-1)&&(hide_val=!0),b.selected&&(hide_val=!1),hide_val)return!1;let filter_item_html=settings.filter_item_html;if(item_title==="price"){filter_item_html=settings.filter_price_html,price_from=Number(b.from),price_to=Number(b.to),price_from_left=Number(b.left),price_to_left=Number(b.right),settings.selected_price&&(price_from!==price_from_left||price_to!==price_to_left)&&(filter_selected_count=1);const price_from_formatted=Shopify.formatMoney(price_from*100,window.money_format),price_to_formatted=Shopify.formatMoney(price_to*100,window.money_format),price_from_left_formatted=Shopify.formatMoney(price_from_left*100,window.money_format),price_to_right_formatted=Shopify.formatMoney(price_to_left*100,window.money_format);filter_item_html=self.updateHtml(filter_item_html,"[[PRICE_FROM_UNFORMATTED]]",price_from),filter_item_html=self.updateHtml(filter_item_html,"[[PRICE_TO_UNFORMATTED]]",price_to),filter_item_html=self.updateHtml(filter_item_html,"[[PRICE_LEFT]]",price_from_left_formatted),filter_item_html=self.updateHtml(filter_item_html,"[[PRICE_RIGHT]]",price_to_right_formatted),filter_item_html=self.updateHtml(filter_item_html,"[[PRICE_FROM]]",price_from_formatted),filter_item_html=self.updateHtml(filter_item_html,"[[PRICE_TO]]",price_to_formatted),filter_item_html=self.updateHtml(filter_item_html,"[[PRICE_FROM_TO_UNFORMATTED]]","restrictBy[price]="+price_from+","+price_to),price_from>price_to||price_from===price_to?filter_item_html=self.updateHtml(filter_item_html,"[[PRICE_FILTER_STATUS]]","disabled"):filter_item_html=self.updateHtml(filter_item_html,"[[PRICE_FILTER_STATUS]]","")}else{item_title==="rating"&&(filter_item_html=settings.filter_rating_html),filter_item_html=self.updateHtml(filter_item_html,"[[TITLE]]",item.title),filter_item_html=self.updateHtml(filter_item_html,"[[VALUE]]",b.value),filter_item_html=self.updateHtml(filter_item_html,"[[VALUE_ENCODE]]",window.encodeURIComponent(b.value)),filter_item_html=self.updateHtml(filter_item_html,"[[VALUE_COUNT]]"," ("+b.count+")");const title_value=self.handleize(item.title+"--"+b.value);filter_item_html=self.updateHtml(filter_item_html,"[[TITLE_VALUE]]",title_value.toLowerCase());let checked="";b.selected&&(filter_selected_count+=1,is_filter_open=!0,checked="checked"),filter_item_html=self.updateHtml(filter_item_html,"[[Check_Status]]",checked),item_title==="rating"&&(filter_item_html=self.updateHtml(filter_item_html,"[[VALUE_FORMATTED]]",buildStars(b)))}filter_item_main+=filter_item_html}),filter_selected_count>0){let active_filter_html='<button aria-controls="search-page-ajax-status" type="button" aria-label="Clear '+item.title+' filter" class="filter-selected-clear"><span class="visually-hidden">Clear '+item.title+" filter</span>&times;</button>",filter_selected_count_html='<span class="filter-selected-count">('+filter_selected_count+")</span>";filter_html=self.updateHtml(filter_html,"[[ACTIVE_FILTER_HTML]]",active_filter_html),filter_html=self.updateHtml(filter_html,"[[FILTER_SELECTED_COUNT]]",filter_selected_count_html),filter_html=self.updateHtml(filter_html,"[[FILTER_ACTIVE_CLASS]]","active"),item_title!=="price"&&(all_filter_selected_count+=filter_selected_count)}else{let active_filter_html='<button aria-controls="search-page-ajax-status" type="button" aria-label="Clear '+item.title+' filter" class="filter-selected-clear hidden"><span class="visually-hidden">Clear '+item.title+" filter</span>&times;</button>";filter_html=self.updateHtml(filter_html,"[[ACTIVE_FILTER_HTML]]",active_filter_html),filter_html=self.updateHtml(filter_html,"[[FILTER_SELECTED_COUNT]]",""),filter_html=self.updateHtml(filter_html,"[[FILTER_ACTIVE_CLASS]]","")}is_filter_open?(filter_html=self.updateHtml(filter_html,"[[FILTER_OPEN_CLASS]]","open"),filter_html=self.updateHtml(filter_html,"[[FILTER_OPEN_CLASS_STATUS]]","true")):(filter_html=self.updateHtml(filter_html,"[[FILTER_OPEN_CLASS]]",""),filter_html=self.updateHtml(filter_html,"[[FILTER_OPEN_CLASS_STATUS]]","false")),filter_html=self.updateHtml(filter_html,"[[FILTER_OPTIONS]]",filter_item_main),filter_html_main+=filter_html});const desk_clearallCTA=this.container.querySelector(selectors.desk_filterClearAllCTA);all_filter_selected_count>0?desk_clearallCTA.classList.remove("hidden"):desk_clearallCTA.classList.add("hidden");function buildStars(bucket){let html="",maxRating=["onestar","twostar","threestar","fourstar","fivestar"].indexOf(bucket.value)+1;if(maxRating>0)for(let i=0;i<maxRating;i++)html+=_theme.product_html.star_fill;else html=_theme.product_html.star_outline;return html}this.container.querySelector(selectors.filter_wrapper).innerHTML=filter_html_main,$(selectors.filter_heading).on("click",function(evt){evt.preventDefault(),evt.stopPropagation(),evt.stopImmediatePropagation(),$(this).parent().find(".filter-list").stop().slideToggle(),$(this).toggleClass("open"),$(this).hasClass("open")?$(this).attr("aria-expanded",!0):$(this).attr("aria-expanded",!1)});const filterWrapper=this.container.querySelector(selectors.filter_wrapper);filterWrapper&&filterWrapper.querySelectorAll('input[type="checkbox"]').forEach(function(input){input.addEventListener("change",function(evt){const inputId=this.id;_theme.toggleLoading(1),settings.start_index=0,settings.total_loaded=0;const new_url=self.buildSearchURL(1);self.fetchSearchResults(new_url,function(){inputId&&document.getElementById(inputId)&&document.getElementById(inputId).focus()})})}),this.container.querySelectorAll(selectors.filterClear).forEach(function(button){button.addEventListener("click",function(evt){evt.preventDefault(),evt.stopPropagation(),evt.stopImmediatePropagation(),_theme.toggleLoading(1);const parent=this.closest("[data-filter-item]"),filterName=parent.dataset.filterName,isPriceFilter=filterName.indexOf("restrictBy[price]")>-1;isPriceFilter&&(settings.selected_price=null),parent.querySelectorAll('ul.scroll-list input[type="checkbox"]').forEach(function(input){input.checked=!1}),settings.start_index=0,settings.total_loaded=0;const new_url=self.buildSearchURL(1,isPriceFilter);self.fetchSearchResults(new_url,function(){const filterItem=document.querySelector('[data-filter-items] [data-filter-item][data-filter-name="'+filterName+'"]');filterItem&&_theme.focusFirstTabbable($(filterItem)),_theme.toggleLoading(0)})})}),this.container.querySelectorAll(selectors.filterSearchInputs).forEach(function(input){input.addEventListener("input",function(evt){let searchTerm=this.value.trim().toLowerCase();this.closest(".filter-list").querySelectorAll("ul.scroll-list > li").forEach(function(item){item.dataset.value.toLowerCase().trim().indexOf(searchTerm)===-1?item.classList.add("hidden"):item.classList.remove("hidden")})})}),this.container.querySelectorAll(selectors.filterClearAllCTA).forEach(function(button){button.addEventListener("click",handleClearAllFilter),button.addEventListener("keydown",_theme.handleKeyboardEnterOrSpacePress);function handleClearAllFilter(evt){evt.preventDefault(),evt.stopPropagation(),evt.stopImmediatePropagation();const _this=this,allInputs=this.closest(".search-result-filter").querySelectorAll('[data-filter-items] ul input[type="checkbox"]'),priceValInput=document.querySelector(".price-range-full");if(allInputs.forEach(function(input){input.checked=!1}),settings.start_index=0,priceValInput){const priceMin=document.querySelector(".price-range-info-min").dataset.priceFrom,priceMax=document.querySelector(".price-range-info-max").dataset.priceTo;priceValInput.value="restrictBy[price]="+priceMin+","+priceMax,settings.selected_price&&(settings.selected_price=null)}const new_url=self.buildSearchURL();_theme.toggleLoading(1),self.fetchSearchResults(new_url,function(){_theme.toggleLoading(0),self.updateStatusText("all items are removed from filter"),setTimeout(function(){_this.previousElementSibling.focus()},1e3)})}}),price_from!=null&&price_to!=null&&$("#filter-price-range").slider({range:!0,min:price_from,max:price_to,step:.1,values:[price_from_left,price_to_left],create:function(event,ui){$("#filter-price-range .ui-slider-handle").attr({role:"button"}),$("#filter-price-range .ui-slider-handle").first().attr("aria-labelledby","price-selected-min"),$("#filter-price-range .ui-slider-handle").last().attr("aria-labelledby","price-selected-max")},slide:function(event,ui){const price_from_formatted=Shopify.formatMoney(ui.values[0]*100,window.money_format),price_to_formatted=Shopify.formatMoney(ui.values[1]*100,window.money_format);$(".price-selected .price-selected-min [data-price-txt]").text(price_from_formatted),$(".price-selected .price-selected-min .visually-hidden").text("minimum price "+price_from_formatted),$(".price-selected .price-selected-max [data-price-txt]").text(price_to_formatted),$(".price-selected .price-selected-max .visually-hidden").text("minimum price "+price_to_formatted),$("[data-filter-items] .price-range-full").val("restrictBy[price]="+ui.values[0]+","+ui.values[1]),settings.selected_price="restrictBy[price]="+ui.values[0]+","+ui.values[1]},change:function(event,ui){const price_from_formatted=Shopify.formatMoney(ui.values[0]*100,window.money_format),price_to_formatted=Shopify.formatMoney(ui.values[1]*100,window.money_format);$(".price-selected .price-selected-min [data-price-txt]").text(price_from_formatted),$(".price-selected .price-selected-min .visually-hidden").text("minimum price "+price_from_formatted),$(".price-selected .price-selected-max [data-price-txt]").text(price_to_formatted),$(".price-selected .price-selected-max .visually-hidden").text("minimum price "+price_to_formatted),$("[data-filter-items] .price-range-full").val("restrictBy[price]="+ui.values[0]+","+ui.values[1]),_theme.toggleLoading(1),settings.start_index=0,settings.total_loaded=0,settings.selected_price="restrictBy[price]="+ui.values[0]+","+ui.values[1]},stop:function(event,ui){const new_url=self.buildSearchURL(1);self.fetchSearchResults(new_url)}})},SearchResult.prototype.updateStatusText=function(msg){const statusElem=document.querySelector(selectors.statusText);!statusElem||!msg||(statusElem.textContent=msg,setTimeout(function(){statusElem.textContent=""},2e3))},SearchResult.prototype.buildProductGrid=function(products){const self=this;let mainHtml="";products.map(function(product,productIndex){if(product.redirect_url)return!1;let product_html=_theme.product_html.productGrid,vid="",variant=product.shopify_variants.filter(function(v){return v.available!="0"})[0];const maxDiscountData=getMaxDiscountAndvariant(product),productUrl=maxDiscountData.availableMaxDiscountVariant&&maxDiscountData.availableMaxDiscountVariant.link||product.link;variant?vid=variant.variant_id:vid=product.shopify_variants[0].variant_id,product_html=self.updateHtml(product_html,"[[Product_Id]]",product.product_id),product_html=self.updateHtml(product_html,"[[Product_Title]]",product.title),product_html=self.updateHtml(product_html,"[[Variant_Id]]",vid),product_html=self.updateHtml(product_html,"[[Product_URL]]",productUrl);var featured_image=product.image_link||"https://cdn.shopify.com/shopifycloud/shopify/assets/no-image-2048-5e88c1b20e087fb7bbe9a3771824e743c244f437e4f8ba93bbf7b11b53f7824c.gif",image="<img alt='"+product.title+"' src='"+featured_image+"' alt='' class='lazyload' tabindex='-1' />";if(product_html=self.updateHtml(product_html,"[[Product_Image_1]]",image),product.shopify_images&&product.shopify_images.length>1){var image_2="<div class='images-two'><img alt='"+product.title+"' src='"+product.shopify_images[1]+"' alt='' class='lazyload' /></div>";product_html=self.updateHtml(product_html,"[[Product_Image_2]]",image_2),product_html=self.updateHtml(product_html,"[[Image_1_Class]]","images-one")}else product_html=self.updateHtml(product_html,"[[Image_1_Class]]",""),product_html=self.updateHtml(product_html,"[[Product_Image_2]]","");product_html=self.updateHtml(product_html,"[[Product_Vendor]]",product.vendor||""),product_html=self.updateHtml(product_html,"[[Product_Vendor_Url]]","/collections/"+self.handleize(product.vendor)||""),product_html=self.updateHtml(product_html,"[[Product_Handle]]",product.link.replace("/products/","")),product_html=self.updateHtml(product_html,"[[Grid_Class]]",buildGridClass(product)),product_html=self.updateHtml(product_html,"[[Product_Price]]",buildPrice(product)),product_html=self.updateHtml(product_html,"[[Product_Labels]]",buildLabels(product)),product_html=self.updateHtml(product_html,"[[Product_PriceOff_Label]]",buildPriceOffLabels(product)),product_html=self.updateHtml(product_html,"[[Product_Bogo_Label]]",buildDiscountLabel(product)),product_html=self.updateHtml(product_html,"[[Product_Notify_CTA]]",buildNotify(product)),mainHtml+=product_html});const searchResultWrapper=this.container.querySelector(selectors.searchResultWrapper);if(settings.is_pagination){const oldHtml=searchResultWrapper.innerHTML;searchResultWrapper.innerHTML=oldHtml+mainHtml,settings.is_pagination=!1}else searchResultWrapper.innerHTML=mainHtml;fetchCallBack(),_theme.toggleLoading(0);function buildLabels(product){let html="";return product.tags&&product.tags!=""&&product.tags.split("[:ATTR:]").map(function(tag){const tag_dcase=tag.trim().toLowerCase();tag_dcase==="bundle-2-for-75"&&(html+='<div class="customOff new">2 for $75 | Mix &amp; Match</div>'),tag_dcase==="online-only-item"&&(html+='<div class="new-tag-style">Online Only</div>'),tag_dcase==="new"&&(html+='<div class="new-tag-style">New</div>')}),html}function buildPriceOffLabels(product){let html="";const maxDiscountData=getMaxDiscountAndvariant(product);if(!maxDiscountData.maxDiscount)return"";const per=maxDiscountData.maxDiscount,variant=maxDiscountData.maxDiscountVariant;return html=`
                  <div class="price-box">
    
                      <div class="price-regular">
    
                          <span class="custom-discount" data-old-price=${variant.list_price}   data-current-price=${variant.price}>
    
                            <span class="text" aria-hidden="true" >
                              Up to
                            </span>
    
                            <span aria-hidden="true" class="discount_text"> 
                            $ ${per} 
                            </span>
    
                            <span aria-hidden="true" class="discount_text">Off</span>
                            <span class="visually-hidden">Up to $ ${per} <span>  Off</span></span>
                          </span>
    
    
    
                      </div>
    
                  </div>
                  
                  `,html}function buildDiscountLabel(product){let html="";return product.tags&&product.tags!=""&&product.tags.split("[:ATTR:]").map(function(tag){const tag_dcase=tag.trim().toLowerCase();if(tag_dcase==="discount-amount"){const discount_per=tag_dcase.split(":")[1];html+='<p class="customOff new">Buy 1 get 1 at '+discount_per+"% off<br>Mix & Match</p>"}else tag_dcase==="bogo-discount"&&(html+='<div class = "price-box"><div class="price-regular"><span class = "bogoTextContainer"><span class="text">BOGO</span><span class="discount_text">50%</span><span class="discount_text">OFF</span></span></div></div>')}),html}function buildPrice(product){let isSoldOut=!1,variant=product.shopify_variants.filter(function(v){return v.available!="0"})[0],prices=product.shopify_variants.map(function(v){return Number(v.price)});variant||(isSoldOut=!0);const price=Shopify.formatMoney(product.price*100,window.money_format);let html='<div class="sale-price pink_color"><span class="visually-hidden">Sale price '+price+'</span><span aria-hidden="true">'+price+"</span></div>";if(prices.length>1){const min_price=Math.min.apply(null,prices),max_price=Math.max.apply(null,prices);if(min_price!==max_price){const min_price_formatted=Shopify.formatMoney(min_price*100,window.money_format),max_price_formatted=Shopify.formatMoney(max_price*100,window.money_format);html='<div class="sale-price pink_color"><span class="visually-hidden">Price range from '+min_price_formatted+" to "+max_price_formatted+'</span><span aria-hidden="true">'+min_price_formatted+" - "+max_price_formatted+"</span></div>"}}return isSoldOut&&(html=""),html}function buildGridClass(product){let html="";return product.shopify_variants.filter(function(v){return v.available!="0"}).length?html="available":html="sold_out",html}function fetchCallBack(){const promoBanner=document.querySelector(selectors.promoBanner),gridItem=document.querySelector(".search-result-main [data-search-results-wrapper] .grid-item:nth-child(10)");if(promoBanner&&gridItem){const promoClone=promoBanner.cloneNode(!0);promoClone.classList.remove("hidden"),gridItem.insertAdjacentElement("afterend",promoClone)}$(".product-item .quick-add-gr .swatch.size").each(function(){let $this=$(this);$this.find(".swatch-element").length>2&&!$this.hasClass("slick-initialized")&&$this.slick({infinite:!1,slidesToShow:2,slidesToScroll:1})}),_theme.Wishlist.init(),_theme.addReviewCount(2e3),document.querySelectorAll("[data-filter-items] ul.scroll-list > li[data-value]").forEach(function(item,index){const $input=item.querySelector("input"),$label=item.querySelector("label");if(!$label)return;const newId=$input.id+"-"+(index+1);$input.setAttribute("id",newId),$label.setAttribute("for",newId)}),setTimeout(function(){document.querySelectorAll("[data-search-results-wrapper] .collection-rating .bv_stars_button_container svg").forEach(function(node_svg){node_svg.removeAttribute("style")})},5e3)}function buildNotify(product){let isSoldOut=!1;product.shopify_variants.filter(function(v){return v.available!="0"})[0]||(isSoldOut=!0);let html="";return isSoldOut&&(html=_theme.product_html.ooS_notify),html}function getMaxDiscountAndvariant(product){let maxDiscount=0,maxDiscountVariant=null,availableMaxDiscount=0,availableMaxDiscountVariant=null;product.shopify_variants&&product.shopify_variants.length>0&&product.shopify_variants.forEach(function(v){const maxPrice=Number(v.list_price);if(!maxPrice||maxPrice<=0)return!1;const price=Number(v.price),discountPer=Math.ceil(maxPrice-price);discountPer>maxDiscount&&(maxDiscount=discountPer,maxDiscountVariant=v),discountPer>availableMaxDiscount&&Number(v.available)&&(availableMaxDiscount=discountPer,availableMaxDiscountVariant=v)});const discountAmt=Number(product.discount),productListPrice=Number(product.list_price);if(!maxDiscount&&discountAmt>0&&productListPrice>0){const per=Math.floor((product.list_price-product.price)*100/product.list_price);maxDiscount=discountAmt||per}return{maxDiscount,maxDiscountVariant,availableMaxDiscount,availableMaxDiscountVariant}}},SearchResult.prototype.buildPagination=function(data){const loadMore=this.container.querySelector(selectors.loadMore),diff=data.totalItems-data.startIndex;loadMore&&(diff<=settings.products_per_page?loadMore.classList.add("hidden"):loadMore.classList.remove("hidden"),this.container.querySelector(selectors.loadMoreProductsCount).innerHTML=settings.total_loaded,this.container.querySelector(selectors.loadMoreTotalCount).innerHTML=data.totalItems)},SearchResult.prototype.initEvents=function(){const self=this,sort_by=this.container.querySelector(selectors.sortby_select);if(sort_by){let handleSortBy=function(evt){const triggerBtn=this.closest("[data-sortby]").querySelector('[data-toggle="dropdown"]');_theme.toggleLoading(1),settings.sort_by=this.value,settings.start_index=0;const new_url=self.buildSearchURL();this.closest("[data-sortby-wrapper]").querySelectorAll(".dropdown-menu").forEach(function(item){item.classList.remove("active")}),self.fetchSearchResults(new_url,()=>{triggerBtn.focus()})};sort_by.addEventListener("change",handleSortBy)}this.container.querySelectorAll(selectors.sortby_select_item).forEach(function(item){item.addEventListener("click",handleCustomSortBy),window.innerWidth>1199&&item.addEventListener("keydown",function(evt){_theme.handleKeyboardEnterOrSpacePress(evt,!0)})});const loadMore=this.container.querySelector(selectors.loadMore),loadMoreButton=this.container.querySelector(selectors.loadMoreButton),paginationLoader=this.container.querySelector(selectors.paginationLoader);if(loadMoreButton){let handleLoadMore=function(evt){settings.is_pagination=!0,loadMore.classList.add("hidden"),paginationLoader.classList.remove("hidden"),settings.start_index=settings.total_loaded;const new_url=self.buildSearchURL(),gridItemsLen=document.querySelectorAll(selectors.gridItem).length;self.fetchSearchResults(new_url,function(){paginationLoader.classList.add("hidden");const nextGridItem=document.querySelectorAll(selectors.gridItem)[gridItemsLen];nextGridItem&&nextGridItem.querySelector(".quickview-button").focus()})};loadMoreButton.addEventListener("click",handleLoadMore)}this.container.querySelectorAll(selectors.filterToggle).forEach(function(button){button.addEventListener("click",function(evt){document.documentElement.classList.toggle(settings.filter_open_class),_theme.isMobile&&$("*").not($(".search-result-filter").find("*")).not(".search-result-filter").not($(".search-result-filter").parents()).removeAttr("aria-hidden"),setTimeout(function(){document.documentElement.classList.contains("filter-open")&&(_theme.focusTrap($(".search-result-filter"),function(){document.documentElement.classList.toggle(settings.filter_open_class)}),_theme.isMobile&&$("*").not($(".search-result-filter").find("*")).not(".search-result-filter").not($(".search-result-filter").parents()).attr("aria-hidden","true"))},250)})}),this.container.querySelectorAll(selectors.dropdown).forEach(function(dropdown){dropdown.addEventListener("click",handleDropdown),window.innerWidth>1199&&dropdown.addEventListener("keydown",_theme.handleKeyboardEnterOrSpacePress)}),this.container.querySelectorAll(selectors.dropdownMenuList).forEach(function(list){list.addEventListener("keydown",handleDropdownEscape)}),this.container.querySelectorAll(selectors.limitedview_item).forEach(function(item){item.addEventListener("click",handleLimitedView),window.innerWidth>1199&&item.addEventListener("keydown",function(evt){_theme.handleKeyboardEnterOrSpacePress(evt,!0)})}),window.addEventListener("click",function(evt){const target=evt.target,hasLimitedView=target.closest("[data-limited-view]"),hasSortBy=target.closest("[data-sortby]");!hasLimitedView&&!hasSortBy&&(document.querySelectorAll('[data-sortby-wrapper] [data-toggle="dropdown"]').forEach(function(item){item.setAttribute("aria-expanded",!1)}),document.querySelectorAll("[data-sortby-wrapper] .dropdown-menu").forEach(function(item,index){item.classList.remove("active")}))});function handleCustomSortBy(evt){const value=this.dataset.href;if(!value)return;const select=this.closest("[data-sortby]").querySelector("select"),text=this.dataset.text,parent=this.closest(".filter-sortby"),parent_ul=this.closest(".dropdown-menu");parent.querySelector(".label-tab .label-text").textContent=text,parent_ul.querySelectorAll("li").forEach(function(li){li.classList.remove("active","select")}),this.classList.add("active"),select.value=value,settings.sort_by=value,parent_ul.classList.remove("active"),select.dispatchEvent(new Event("change"))}function handleDropdown(evt){evt.preventDefault();const that=this,selfDropdown=this.parentElement.querySelector(".dropdown-menu");this.closest("[data-sortby-wrapper]").querySelectorAll(".dropdown-menu").forEach(function(item,index){item!==selfDropdown&&(item.parentElement.setAttribute("aria-expanded",!1),item.classList.remove("active"))}),selfDropdown&&(selfDropdown.classList.toggle("active"),selfDropdown.classList.contains("active")?(this.setAttribute("aria-expanded",!0),_theme.focusTrap($(selfDropdown),function(){that.setAttribute("aria-expanded",!1),that.focus()},'li[tabindex="0"]')):this.setAttribute("aria-expanded",!1))}function handleDropdownEscape(evt){if(evt.key&&evt.key.toUpperCase()==="ESCAPE"){const titleElem=this.parentElement.querySelector('[data-toggle="dropdown"]');titleElem.setAttribute("aria-expanded",!1),titleElem.focus(),this.classList.remove("active")}}function handleLimitedView(evt){evt.preventDefault();const count=Number(this.dataset.value);if(!count)return;const triggerBtn=this.closest(".limited-view").querySelector('[data-toggle="dropdown"]');triggerBtn.querySelector('[name="paginateBy"] span').textContent=count,this.closest("ul.dropdown-menu").querySelectorAll("li").forEach(function(li){li.classList.remove("active"),li.setAttribute("aria-selected",!1)}),this.classList.add("active"),this.setAttribute("aria-selected",!0),this.closest(".dropdown-menu").classList.remove("active"),_theme.toggleLoading(1),settings.products_per_page=count;const new_url=self.buildSearchURL();this.closest("[data-sortby-wrapper]").querySelectorAll(".dropdown-menu").forEach(function(item){item.classList.remove("active")}),self.fetchSearchResults(new_url,()=>{triggerBtn.focus()})}},SearchResult.prototype.buildSearchURL=function(filterPrice,resetPrice){let base_url=settings.base_url+"&sortBy="+settings.sort_by;const filter_items=this.container.querySelectorAll(selectors.filter_item);if(filter_items&&filter_items.length&&(filter_items.forEach(function(filter_item){const checked_inputs=Array.from(filter_item.querySelectorAll('input[type="checkbox"]')).filter(function(input){return input.checked});if(checked_inputs&&checked_inputs.length){const filterName=filter_item.dataset.filterName,input_len=checked_inputs.length;let values="";checked_inputs.forEach(function(input,index){values+=input.value,index+1<input_len&&(values+="|")}),base_url+="&"+filterName+"="+values}}),settings.selected_price)){const priceQueryString=$("[data-filter-items] .price-range-full").val();base_url+="&"+(settings.selected_price||priceQueryString)}let maxResults=settings.products_per_page;return base_url+="&startIndex="+settings.start_index+"&maxResults="+maxResults,base_url},SearchResult.prototype.updateHtml=function(html,str,data){var newhtml=html;return newhtml.indexOf(str)>-1?(newhtml=newhtml.replace(str,data),this.updateHtml(newhtml,str,data)):newhtml},SearchResult.prototype.handleize=function(str){return str.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-$/,"").replace(/^-/,"")},SearchResult}(),window.addEventListener("DOMContentLoaded",function(event){new _theme.SearchResult});
//# sourceMappingURL=/cdn/shop/t/292/assets/search-result.js.map?v=109404817362411120331710317149
